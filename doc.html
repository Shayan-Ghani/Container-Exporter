<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>CXP - Container Exporter Docs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Container Exporter (CXP) for Prometheus - Docs and Guides.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --brand-main: #FF5722;
            /* for buttons & links */
            --brand-heading: #FFA07A;
            /* for h1/h2 */
            --brand-accent: #FFAB91;
            /* for h3, hover states */
        }


        body {
            background-color: #0d0d0d;
            font-family: "Source Code Pro", monospace;
            font-size: 18px;
            color: #fafafa;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem;
            gap: 2rem;
            min-height: 100vh;
        }

        .background {
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, #222 1px, transparent 1px);
            background-size: 40px 40px;
            animation: moveBackground 30s linear infinite;
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.12;
        }

        @keyframes moveBackground {
            0% {
                background-position: 0 0;
            }

            100% {
                background-position: -50px -50px;
            }
        }

        .container {
            max-width: 850px;
            width: 100%;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.04);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            backdrop-filter: blur(8px);
            box-shadow: 0 0 50px rgba(255, 69, 0, 0.12);
            display: flex;
            flex-direction: column;
            gap: 1.8rem;
            line-height: 2.5rem;

        }

        h1 {
            color: var(--brand-main);
            font-size: 2.6rem;
        }

        h2 {
            color: var(--brand-main);
            font-size: 1.8rem;
        }

        h3 {
            color: #ffa07a;
            font-size: 1.4rem;
        }

        p {
            line-height: 2.5rem;
            color: #ccc;
        }

        ol,
        ul {
            padding-left: 2.5rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            color: #ccc;
        }

        li {
            line-height: 1.6;
        }

        pre {
            background: #111;
            color: #fafafa;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            line-height: 1.6;
        }

        code {
            background: #111;
            color: #fafafa;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.95em;
        }

        img {
            max-width: 100%;
            border-radius: 8px;
        }

        a {
            color: var(--brand-main);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .badge {
            margin-right: .5rem;
            vertical-align: middle;
        }

        .footer {
            text-align: center;
            font-size: 0.9em;
            color: #777;
            margin-top: 2rem;
        }

        .section {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }


        .badges {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }


        h1 {
            color: var(--brand-heading);
            font-size: 2.6rem;
        }

        h2 {
            color: var(--brand-heading);
            font-size: 1.8rem;
        }

        h3 {
            color: var(--brand-accent);
            font-size: 1.4rem;
        }

    </style>
</head>

<body>
    <div class="background"></div>

    <div class="container">
        <h1>üöÄ Container Exporter (CXP)</h1>
        <p>A resource-friendly, highly efficient Prometheus exporter for monitoring Docker containers' Memory, CPU,
            Disk, and Network I/O usage ‚Äî with uptime tracking.</p>
        <p>when a container is not running due to whatever reason <code>cxp</code> removes all its stats metrics (cpu,
            memory, etc.)
            <code>(if CONTAINER_EXPORTER_CLEAR_METRICS=True otherwise they are set to 0 to retain time series data.)</code>
            but keeps its status ( running/not-running/(restarting/unhealthy) ) to facilitate alerting in case something
            goes wrong with that contaier.
        </p>

        <p>Check out a sample of the metrics output <a href="./metrics.html">here</a> to see how it works.</p>
        <div class="section">
            <h2>üìö Table of Contents</h2>
            <ol>
                <li><a href="#dev-stack">DEV STACK</a></li>
                <li><a href="#demo">DEMO</a></li>
                <li><a href="#guide">Deployment Guide</a></li>
                <li><a href="#settings">Config and Settings</a></li>
                <li><a href="#grafana">Grafana Dashboards</a></li>
                <li><a href="#alerting">Alerting</a></li>
            </ol>
        </div>

        <div class="section" id="dev-stack">
            <h2>üõ†Ô∏è DEV STACK</h2>
            <div class="badges">

                <img class="badge"
                    src="https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54">
                <img class="badge"
                    src="https://img.shields.io/badge/fastapi-%23000.svg?style=for-the-badge&logo=fastapi&logoColor=ffdd54">
                <img class="badge"
                    src="https://img.shields.io/badge/docker-3670A0?style=for-the-badge&logo=docker&logoColor=ffff">
                <img class="badge"
                    src="https://img.shields.io/badge/Prometheus-E6522C?style=for-the-badge&logo=Prometheus&logoColor=white">
                <img class="badge"
                    src="https://img.shields.io/badge/gunicorn-298729?style=for-the-badge&logo=gunicorn&logoColor=white">
            </div>
        </div>

        <div class="section" id="demo">
            <h2>üé• DEMO</h2>
            <img src="https://shayan-ghani.github.io/Container-Exporter/CXP-DEMO.gif" alt="CXP Demo GIF">
        </div>

        <div class="section" id="settings">
            <h2>Config and Settings </h2>
            <div class="config">
                <h3>Uvicorn</h3>
                <p>the following settings can be set via exporting environment variables and are applied to <code>start.sh</code> entrypoint. </p>
                <ul>
                    <li>HOST (Default: 0.0.0.0)</li>
                    <li>PORT (Default: 8000)</li>
                    <li>WORKERS: Prometheus Multi-Processesing needed, not Implemented yet as of version [1.3.0] (Default : 1)</li>
                    <li>LOG_LEVEL (Default : warning) </li>
                </ul>
            </div>
            <h3>App Settings</h3>
            <p>the following settings can be set via exporting environment variables or a <code>.env</code> file. </p>
            <ul>
                <li><code>CONTAINER_EXPORTER_CLEAR_METRICS</code> (Default: True)</li>
                <p>when set to False the metrics for container stats will not be fully cleared and set to zero to retain the time series data recorded for that container.
                    note that only <b>Gauge Metrics</b>  can be set to zero, so <code>network</code> and <code>disk io</code> settings will be fully cleared either way.
                </p>
            </ul>
            <div class="config">
                
            </div>


        </div>

        <div class="section" id="guide">
            <h2>üìã Deployment Guide</h2>

            <h3>Before You Start</h3>
            <ul>
                <li>Ensure port <code>8000</code> is open</li>
                <li>Docker & Docker Compose installed (optional)</li>
                <li>Git and Python ‚â• 3.10 available</li>
            </ul>

            <h3>‚öôÔ∏è Deploy with GitHub Actions</h3>
            <ul>
                <li>Fork the repository.</li>
                <li>Go to the forked repository and switch to the Actions tab.</li>
                <li>Click the <code>I understand my workflows, go ahead and enable them</code> button.</li>
                <li>Now you have access to all of the workflows; however, make sure you change the secrets listed below
                    accordingly:
                    <ul>
                        <li><code>secrets.DOCKER_TOKEN</code>: the personal access token for Docker Hub of your (or your
                            organization‚Äôs) account.</li>
                        <li><code>secrets.GHCR_TOKEN</code>: GitHub classic access token with
                            <code>packages:read-write</code> permissions, or simply use
                            <code>${{ github.token }}</code>.
                        </li>
                    </ul>
                </li>
            </ul>

            <h3>How Workflows Work</h3>
            <ul>
                <li>On push to <code>master</code>, the project will be built, deployed, and released. Since deploying
                    to your servers requires runner configuration, it must be triggered manually; you can modify its
                    behavior in the <code>cd.yml</code> workflow.</li>
                <li>On push to any branch except <code>master</code>, code will be built and health-checked.</li>
                <li>On pull request, the project will be health-checked and built.</li>
            </ul>

            <bold>Double check the required variables and secrets to prevent any unexpected failures.</bold>


            <h3>With Docker Compose</h3>
            <pre>git clone https://github.com/Shayan-Ghani/Container-exporter.git
cd Container-Exporter
chmod +x ./start.sh
docker-compose -f container-exporter.yml up -d</pre>

            <h3>Without Docker</h3>
            <pre>python3 -m venv venv
source venv/bin/activate
pip install -U pip
pip install -r requirements.txt
./start.sh &</pre>

            <h3>Add CXP to Prometheus</h3>
            <p>
                Modify your <code>prometheus.yml</code> scrape configs and point to <code>localhost:8000/metrics</code>.
            </p>
            <img src="./scrape-config.png" alt="Scrape config example">

            <div class="section" id="grafana">
                <h2>üìä Grafana Dashboards</h2>
                <p>
                    Import dashboards from the <code>./dashboards</code> directory and use <code>dashboard-gen.sh</code>
                    to auto-replace datasource UIDs.
                </p>
            </div>
            <div class="section" id="alerting">
                <h2>Alerting Rules</h2>
                <p>
                    A page of sample Prometheus rules can be accessed <a href="./rules.html">here</a> . setting alerts on <code>cxp_container_status</code> is one of the main points users prefer <code>CXP</code> over<code>cAdvisor.</code> 
                </p>
            </div>

            <div class="footer">
                Built for reliability. Inspired by Prometheus.
            </div>
        </div>

</body>

</html>